{% extends 'base.html' %}

{% block content %}
<style>
 .tituloTime{
  height: 30px;
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
 }
 h6{
  font-size: 30px;
  font-weight: bold;
  text-align: center;
 }
 p{
  font-size: 30px;
  font-weight: bold;
 }
 .btnsaida{
  text-decoration: none;
  color:white;
 }
 .btstart{
    text-align: center;
    align-items: center;
    font-weight: bold;
    font-size: 400%;
 }

 .btnempate{
  text-align: center;
  align-items: center;
  font-weight: bold;
  font-size: 350%;
  font-family: serif;
  text-decoration: none;
  color: black;
 }
</style>


<!--  MODAL PARA DIV SUPENSO COM A PRIORIDADE DO EMPATE -->

<!-- Modal -->
<div class="modal fade" id="modalprioridade" tabindex="-1" aria-labelledby="modalprioridadelabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="modalprioridadeLabel">Qual a prioridade para próximos? </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <form method="get" class="form-inline">
        {% csrf_token %}
        <div class="modal-body"> <!-- INICIO modal-body-->

          <!-- <a type="button"  class="btn btn-secondary" href="?perdedor=prioridadeazul" style=" width: 50px; height: 100px;background-color: blue"></a>
          <a type="button"  class="btn btn-secondary" href="?perdedor=prioridadevermelho" style=" width: 50%; height: 100px;background-color: red"></a>
          -->
          <div class="row col-sm-6 col-md-6 col-lg-6">
            <a type="button"  href="?perdedor=prioridadeazul"  class="btnempate"style=" height: 100px;background-color: blue"></a>
          </div>
          
          <div class="row col-sm-6 col-md-6 col-lg-6">
            <a type="button" href="?perdedor=prioridadevermelho" class="btnempate" style=" height: 100px; background-color: red "></a>
          </div>

        </div> <!-- FIM modal-body-->
        <div class="modal-footer">
          <a type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</a>
        </div>
      </form>
    </div>
  </div>
</div>

<!--  FINAL DA MODAL DA PRIORIDADE MODAL-->




<div class="row" style="box-shadow:0 0 5px 0px grey; padding-bottom: 20px; padding: 20px; display: flex; justify-content: center; align-items: center;" >
  <div class="col-sm-12 col-md-12 col-lg-12 text-center" style="box-shadow:0 0 5px 0px grey;">

  <h2 style="font-weight: bold; color: white; background-color: black;" class="text-center" >JOGANDO COM {{pelada.quantidade_jogadores}} JOGADORES POR TIME</h2>

  <div class="row">
    <div class="col-sm-6 col-md-6 col-lg-6 text-center" style=" background-color: blue;color: white;">
      <h3 class="text-center" style="background-color: white; color: blue; border: 1px solid blue;"> TIME AZUL</h3>

      {% for jog in time_azul %}
        <p>{{jog.nome}}</p>
      {% endfor %}

    </div>   <!-- f coluna 1-->

    <div class="col-sm-6 col-md-6 col-lg-6 text-center" style="background-color: red;color: white;">
      <h3 class="text-center" style="background-color: white; color: red; border: 1px solid red;"> TIME VERMELHO</h3>

      {% for jog in time_vermelho %}
        <p>{{jog.nome}}</p>
      {% endfor %}

    </div>  <!-- f coluna 2 -->
 
  </div> <!-- row-->

</div> <!-- div sombra-->

  <div class="row text-center " style="box-shadow:0 0 5px 0px grey; padding-bottom: 20px; padding: 20px; background-color: black;" >
    <h2 style="font-weight: bold; color: black; background-color: white;" class="text-center" >TEMPORIZADOR</h2>
    <div class="col-sm-12 col-md-12 col-lg-12">
      <h2>
          <p style="font-size: 100%; color: white;">TEMPO RESTANTE<br>
            <span id="timer" style="color: red;" >
              <strong>{{pelada.tempo_pelada}}</strong>
            </span> Minuto(s)
          </p>           
      </h2>
      <a class="btn btn-success btstart" type="button" id="btnstartime" onclick="startTimer({{pelada.tempo_pelada}})" style="width: 70%; height: 100px;">INICIAR</a>
      </br>
      <a class="btn btn-danger btstart" type="button" id="btnpausetime" onclick="pauseTimer()" style="width: 30%; height: 100px;">Pause</a>
      <a class="btn btn-warning btstart" type="button" id="btnresumetime" onclick="resumeTimer()" style="width: 30%; height: 100px; color: white;">Play</a>
    </div>
  </div>
  
  </br>
  <div class="row" id="divSuspenso" style="background-color: black; display:flex; justify-content: center; align-items: center;" >
    <h2 style="font-weight: bold; color: black; background-color: white;" class="text-center" >QUEM SAI?</h2>
      <div class="row col-sm-4 col-md-4 col-lg-4">
        <a type="button"  href="?perdedor=azul"  class="btnempate"style="width:90%; height: 100px;background-color: blue"></a>
      </div>
      <div class="row col-sm-4 col-md-4 col-lg-4">
        <button type="button" data-toggle="modal" data-target="#modalprioridade" class="btnempate" style="width:90%; height: 100px;background-color: white ">EMPATE</button>
      </div>
      <div class="row col-sm-4 col-md-4 col-lg-4">
        <a type="button" href="?perdedor=vermelho" class="btnempate" style="width:90%; height: 100px; background-color: red "></a>
      </div>
      <p></p>
  </div>


<div class="row" style="box-shadow:0 0 5px 0px grey; padding-bottom: 20px; padding: 20px;" >
  <h2 style="font-weight: bold; color: white; background-color: black;" class="text-center" >PRÓXIMOS</h2>

  <div class="row">
    <div class="col-sm-12 col-md-12 col-lg-12" style="box-shadow:0 0 5px 0px grey; ">
      <table class="table table-striped" >
        <thead>
          <tr>
            <th scope="col">POSIÇAO</th>
            <th scope="col">NOME</th>
          </tr>
        </thead>
        <tbody>
          {% for jogador in proximos %}
            <tr style="font-size: 30px;">
              <th scope="row" >{{ jogador.posicao }}</th>
              <td >{{ jogador.nome }}</td>
              {% endfor %}
            </tr>
        </tbody>
      </table>
    </div>
  </div> <!-- ROW-->
  </br>
</div> <!-- sombra div-->


<script>
	let timer = null;
  //let timerInterval;
  let paused = false;
  var div = document.getElementById("divSuspenso");
  var divtemp = document.getElementById("divtemp");
  
  //const link = document.getElementById('btnbluesai');  
  //const link2 = document.getElementById('btnredsai');
  const link3 = document.getElementById('btnstartime');

    
		function startTimer(tempo) {     
      div.style.display = "none";
      disableLink();
      paused = false;
			var time = tempo*60;
			var minutes = parseInt(time / 60, 10);
			var seconds = parseInt(time % 60, 10);  

      function updateTimer() {
        if (paused) return; // adicionando verificação para pausa
        document.getElementById("timer").innerHTML = minutes.toString() + ":" + (seconds < 10 ? "0" : "") + seconds.toString();
        if (--seconds < 0) {
          seconds = 59;
          if (--minutes < 0) {
            clearInterval(timer);
            enableLink();            
            div.style.display = "flex";
            divtemp.style.display = "none";
            alert("JOGO FINALIZADO!");
          }
        }
      }
  
      updateTimer();
      timer = setInterval(updateTimer, 1000);
    }

    function pauseTimer() {
      paused = true;
      clearInterval(timer);
    }

    function resumeTimer() {
      paused = false;
      timer = setInterval(updateTimer, 1000);
    }


    

    function disableLink() {
      // link.style.pointerEvents = 'none';
      // link2.style.pointerEvents = 'none';
      link3.style.pointerEvents = 'none';
    }

    function enableLink() {
      // link.style.pointerEvents = 'auto';
      // link2.style.pointerEvents = 'auto';
      link3.style.pointerEvents = 'auto';
    }

    link.addEventListener('click', function(event) {
      if (link.style.pointerEvents === 'none') {
        event.preventDefault();
      }
    });
    link2.addEventListener('click', function(event) {
      if (link2.style.pointerEvents === 'none') {
        event.preventDefault();
      }
    });
    link3.addEventListener('click', function(event) {
      if (link3.style.pointerEvents === 'none') {
        event.preventDefault();
      }
    });
  </script>

{% endblock %}
